{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/db/mongoose.ts"],"sourcesContent":["import mongoose from \"mongoose\"\n\nconst MONGODB_URI = process.env.MONGODB_URI\n\nif (!MONGODB_URI) {\n  throw new Error(\"Please define the MONGODB_URI environment variable\")\n}\n\nlet cached = (global as any).mongoose\n\nif (!cached) {\n  cached = (global as any).mongoose = { conn: null, promise: null }\n}\n\nexport async function connectDB() {\n  if (cached.conn) {\n    return cached.conn\n  }\n\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false,\n    }\n\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      return mongoose\n    })\n  }\n\n  try {\n    cached.conn = await cached.promise\n  } catch (e) {\n    cached.promise = null\n    throw e\n  }\n\n  return cached.conn\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAEA,IAAI,SAAS,yDAAgB,QAAQ;AAErC,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAgB,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AAClE;AAEO,eAAe;IACpB,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/models/User.ts"],"sourcesContent":["import mongoose, { Schema, type Document } from \"mongoose\"\nimport type { IUser } from \"../types\"\n\ninterface UserDocument extends Document, IUser {}\n\nconst userSchema = new Schema<UserDocument>(\n  {\n    name: {\n      type: String,\n      required: true,\n    },\n    email: {\n      type: String,\n      required: true,\n      unique: true,\n      lowercase: true,\n      match: /^\\S+@\\S+\\.\\S+$/,\n    },\n    passwordHash: {\n      type: String,\n      required: true,\n      select: false, // Don't return password hash by default\n    },\n    role: {\n      type: String,\n      enum: [\"admin\", \"business_owner\", \"investor\"],\n      default: \"investor\",\n      required: true,\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  {\n    timestamps: true,\n  },\n)\n\n// Indexes for performance\nuserSchema.index({ email: 1 })\nuserSchema.index({ role: 1 })\nuserSchema.index({ isActive: 1 })\n\nexport const User = mongoose.models.User || mongoose.model<UserDocument>(\"User\", userSchema)\n"],"names":[],"mappings":";;;;AAAA;;AAKA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;IACZ;IACA,OAAO;QACL,MAAM;QACN,UAAU;QACV,QAAQ;QACR,WAAW;QACX,OAAO;IACT;IACA,cAAc;QACZ,MAAM;QACN,UAAU;QACV,QAAQ;IACV;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAS;YAAkB;SAAW;QAC7C,SAAS;QACT,UAAU;IACZ;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,0BAA0B;AAC1B,WAAW,KAAK,CAAC;IAAE,OAAO;AAAE;AAC5B,WAAW,KAAK,CAAC;IAAE,MAAM;AAAE;AAC3B,WAAW,KAAK,CAAC;IAAE,UAAU;AAAE;AAExB,MAAM,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAe,QAAQ"}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/db/auth.ts"],"sourcesContent":["import bcrypt from \"bcryptjs\"\nimport { User } from \"../models/User\"\nimport { connectDB } from \"./mongoose\"\nimport type { SessionUser } from \"../types\"\n\n/**\n * Hash password for secure storage\n */\nexport async function hashPassword(password: string): Promise<string> {\n  const salt = await bcrypt.genSalt(10)\n  return bcrypt.hash(password, salt)\n}\n\n/**\n * Compare password with hash\n */\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash)\n}\n\n/**\n * Find user by email\n */\nexport async function findUserByEmail(email: string): Promise<any> {\n  await connectDB()\n  const user = await User.findOne({ email: email.toLowerCase() }).select(\"+passwordHash\")\n  return user ? user.toObject() : null\n}\n\n/**\n * Get user session data (without password)\n */\nexport async function getUserSession(userId: string): Promise<SessionUser | null> {\n  await connectDB()\n  const user = await User.findById(userId)\n  if (!user) return null\n\n  return {\n    id: user._id.toString(),\n    email: user.email,\n    name: user.name,\n    role: user.role,\n  }\n}\n\n/**\n * Create a new user (Admin only)\n */\nexport async function createUser(\n  name: string,\n  email: string,\n  password: string,\n  role: \"admin\" | \"business_owner\" | \"investor\",\n): Promise<any> {\n  await connectDB()\n\n  const existingUser = await User.findOne({ email: email.toLowerCase() })\n  if (existingUser) {\n    throw new Error(\"User with this email already exists\")\n  }\n\n  const passwordHash = await hashPassword(password)\n\n  const user = await User.create({\n    name,\n    email: email.toLowerCase(),\n    passwordHash,\n    role,\n  })\n\n  return {\n    _id: user._id.toString(),\n    name: user.name,\n    email: user.email,\n    role: user.role,\n    isActive: user.isActive,\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;AACA;;;;AAMO,eAAe,aAAa,QAAgB;IACjD,MAAM,OAAO,MAAM,mMAAM,CAAC,OAAO,CAAC;IAClC,OAAO,mMAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAKO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,OAAO,mMAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAKO,eAAe,gBAAgB,KAAa;IACjD,MAAM,IAAA,oIAAS;IACf,MAAM,OAAO,MAAM,+HAAI,CAAC,OAAO,CAAC;QAAE,OAAO,MAAM,WAAW;IAAG,GAAG,MAAM,CAAC;IACvE,OAAO,OAAO,KAAK,QAAQ,KAAK;AAClC;AAKO,eAAe,eAAe,MAAc;IACjD,MAAM,IAAA,oIAAS;IACf,MAAM,OAAO,MAAM,+HAAI,CAAC,QAAQ,CAAC;IACjC,IAAI,CAAC,MAAM,OAAO;IAElB,OAAO;QACL,IAAI,KAAK,GAAG,CAAC,QAAQ;QACrB,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;QACf,MAAM,KAAK,IAAI;IACjB;AACF;AAKO,eAAe,WACpB,IAAY,EACZ,KAAa,EACb,QAAgB,EAChB,IAA6C;IAE7C,MAAM,IAAA,oIAAS;IAEf,MAAM,eAAe,MAAM,+HAAI,CAAC,OAAO,CAAC;QAAE,OAAO,MAAM,WAAW;IAAG;IACrE,IAAI,cAAc;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,eAAe,MAAM,aAAa;IAExC,MAAM,OAAO,MAAM,+HAAI,CAAC,MAAM,CAAC;QAC7B;QACA,OAAO,MAAM,WAAW;QACxB;QACA;IACF;IAEA,OAAO;QACL,KAAK,KAAK,GAAG,CAAC,QAAQ;QACtB,MAAM,KAAK,IAAI;QACf,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;QACf,UAAU,KAAK,QAAQ;IACzB;AACF"}},
    {"offset": {"line": 278, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth, { type NextAuthOptions } from \"next-auth\"\nimport CredentialsProvider from \"next-auth/providers/credentials\"\nimport { connectDB } from \"@/lib/db/mongoose\"\nimport { findUserByEmail, verifyPassword } from \"@/lib/db/auth\"\n\nexport const authOptions: NextAuthOptions = {\n  providers: [\n    CredentialsProvider({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\", placeholder: \"user@example.com\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          throw new Error(\"Invalid credentials\")\n        }\n\n        try {\n          await connectDB()\n\n          // Find user by email\n          const user = await findUserByEmail(credentials.email)\n          if (!user) {\n            throw new Error(\"Invalid email or password\")\n          }\n\n          // Check if user is active\n          if (!user.isActive) {\n            throw new Error(\"User account is deactivated\")\n          }\n\n          // Verify password\n          const isValid = await verifyPassword(credentials.password, user.passwordHash)\n          if (!isValid) {\n            throw new Error(\"Invalid email or password\")\n          }\n\n          // Return user object for session\n          return {\n            id: user._id.toString(),\n            email: user.email,\n            name: user.name,\n            role: user.role,\n          }\n        } catch (error) {\n          throw new Error(error instanceof Error ? error.message : \"Authentication failed\")\n        }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      // On login, add user data to token\n      if (user) {\n        token.id = user.id\n        token.role = (user as any).role\n        token.name = user.name\n      }\n      return token\n    },\n    async session({ session, token }) {\n      // Add token data to session\n      if (session.user) {\n        session.user = {\n          id: token.id as string,\n          email: token.email || \"\",\n          name: token.name as string,\n          role: token.role as any,\n        }\n      }\n      return session\n    },\n  },\n  pages: {\n    signIn: \"/login\",\n    error: \"/login\",\n  },\n  secret: process.env.NEXTAUTH_SECRET,\n  session: {\n    strategy: \"jwt\",\n    maxAge: 30 * 24 * 60 * 60, // 30 days\n  },\n}\n\nconst handler = NextAuth(authOptions)\nexport { handler as GET, handler as POST }\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAEO,MAAM,cAA+B;IAC1C,WAAW;QACT,IAAA,uXAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;oBAAS,aAAa;gBAAmB;gBACxE,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,IAAI;oBACF,MAAM,IAAA,oIAAS;oBAEf,qBAAqB;oBACrB,MAAM,OAAO,MAAM,IAAA,sIAAe,EAAC,YAAY,KAAK;oBACpD,IAAI,CAAC,MAAM;wBACT,MAAM,IAAI,MAAM;oBAClB;oBAEA,0BAA0B;oBAC1B,IAAI,CAAC,KAAK,QAAQ,EAAE;wBAClB,MAAM,IAAI,MAAM;oBAClB;oBAEA,kBAAkB;oBAClB,MAAM,UAAU,MAAM,IAAA,qIAAc,EAAC,YAAY,QAAQ,EAAE,KAAK,YAAY;oBAC5E,IAAI,CAAC,SAAS;wBACZ,MAAM,IAAI,MAAM;oBAClB;oBAEA,iCAAiC;oBACjC,OAAO;wBACL,IAAI,KAAK,GAAG,CAAC,QAAQ;wBACrB,OAAO,KAAK,KAAK;wBACjB,MAAM,KAAK,IAAI;wBACf,MAAM,KAAK,IAAI;oBACjB;gBACF,EAAE,OAAO,OAAO;oBACd,MAAM,IAAI,MAAM,iBAAiB,QAAQ,MAAM,OAAO,GAAG;gBAC3D;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,mCAAmC;YACnC,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,AAAC,KAAa,IAAI;gBAC/B,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,4BAA4B;YAC5B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,GAAG;oBACb,IAAI,MAAM,EAAE;oBACZ,OAAO,MAAM,KAAK,IAAI;oBACtB,MAAM,MAAM,IAAI;oBAChB,MAAM,MAAM,IAAI;gBAClB;YACF;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;IACnC,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;AACF;AAEA,MAAM,UAAU,IAAA,oWAAQ,EAAC"}}]
}