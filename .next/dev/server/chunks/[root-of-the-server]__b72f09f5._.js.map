{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/models/User.ts"],"sourcesContent":["import mongoose, { Schema, type Document } from \"mongoose\"\nimport type { IUser } from \"../types\"\n\ninterface UserDocument extends Document, IUser {}\n\nconst userSchema = new Schema<UserDocument>(\n  {\n    name: {\n      type: String,\n      required: true,\n    },\n    email: {\n      type: String,\n      required: true,\n      unique: true,\n      lowercase: true,\n      match: /^\\S+@\\S+\\.\\S+$/,\n    },\n    passwordHash: {\n      type: String,\n      required: true,\n      select: false, // Don't return password hash by default\n    },\n    role: {\n      type: String,\n      enum: [\"admin\", \"business_owner\", \"investor\"],\n      default: \"investor\",\n      required: true,\n    },\n    isActive: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  {\n    timestamps: true,\n  },\n)\n\n// Indexes for performance\nuserSchema.index({ email: 1 })\nuserSchema.index({ role: 1 })\nuserSchema.index({ isActive: 1 })\n\nexport const User = mongoose.models.User || mongoose.model<UserDocument>(\"User\", userSchema)\n"],"names":[],"mappings":";;;;AAAA;;AAKA,MAAM,aAAa,IAAI,mHAAM,CAC3B;IACE,MAAM;QACJ,MAAM;QACN,UAAU;IACZ;IACA,OAAO;QACL,MAAM;QACN,UAAU;QACV,QAAQ;QACR,WAAW;QACX,OAAO;IACT;IACA,cAAc;QACZ,MAAM;QACN,UAAU;QACV,QAAQ;IACV;IACA,MAAM;QACJ,MAAM;QACN,MAAM;YAAC;YAAS;YAAkB;SAAW;QAC7C,SAAS;QACT,UAAU;IACZ;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,0BAA0B;AAC1B,WAAW,KAAK,CAAC;IAAE,OAAO;AAAE;AAC5B,WAAW,KAAK,CAAC;IAAE,MAAM;AAAE;AAC3B,WAAW,KAAK,CAAC;IAAE,UAAU;AAAE;AAExB,MAAM,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAe,QAAQ"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/db/mongoose.ts"],"sourcesContent":["import mongoose from \"mongoose\"\n\nconst MONGODB_URI = process.env.MONGODB_URI\n\nif (!MONGODB_URI) {\n  throw new Error(\"Please define the MONGODB_URI environment variable\")\n}\n\nlet cached = (global as any).mongoose\n\nif (!cached) {\n  cached = (global as any).mongoose = { conn: null, promise: null }\n}\n\nexport async function connectDB() {\n  if (cached.conn) {\n    return cached.conn\n  }\n\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false,\n    }\n\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      return mongoose\n    })\n  }\n\n  try {\n    cached.conn = await cached.promise\n  } catch (e) {\n    cached.promise = null\n    throw e\n  }\n\n  return cached.conn\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAEA,IAAI,SAAS,yDAAgB,QAAQ;AAErC,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAgB,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AAClE;AAEO,eAAe;IACpB,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB"}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/db/auth.ts"],"sourcesContent":["import bcrypt from \"bcryptjs\"\nimport { User } from \"../models/User\"\nimport { connectDB } from \"./mongoose\"\nimport type { SessionUser } from \"../types\"\n\n/**\n * Hash password for secure storage\n */\nexport async function hashPassword(password: string): Promise<string> {\n  const salt = await bcrypt.genSalt(10)\n  return bcrypt.hash(password, salt)\n}\n\n/**\n * Compare password with hash\n */\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  return bcrypt.compare(password, hash)\n}\n\n/**\n * Find user by email\n */\nexport async function findUserByEmail(email: string): Promise<any> {\n  await connectDB()\n  const user = await User.findOne({ email: email.toLowerCase() }).select(\"+passwordHash\")\n  return user ? user.toObject() : null\n}\n\n/**\n * Get user session data (without password)\n */\nexport async function getUserSession(userId: string): Promise<SessionUser | null> {\n  await connectDB()\n  const user = await User.findById(userId)\n  if (!user) return null\n\n  return {\n    id: user._id.toString(),\n    email: user.email,\n    name: user.name,\n    role: user.role,\n  }\n}\n\n/**\n * Create a new user (Admin only)\n */\nexport async function createUser(\n  name: string,\n  email: string,\n  password: string,\n  role: \"admin\" | \"business_owner\" | \"investor\",\n): Promise<any> {\n  await connectDB()\n\n  const existingUser = await User.findOne({ email: email.toLowerCase() })\n  if (existingUser) {\n    throw new Error(\"User with this email already exists\")\n  }\n\n  const passwordHash = await hashPassword(password)\n\n  const user = await User.create({\n    name,\n    email: email.toLowerCase(),\n    passwordHash,\n    role,\n  })\n\n  return {\n    _id: user._id.toString(),\n    name: user.name,\n    email: user.email,\n    role: user.role,\n    isActive: user.isActive,\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;AACA;;;;AAMO,eAAe,aAAa,QAAgB;IACjD,MAAM,OAAO,MAAM,mMAAM,CAAC,OAAO,CAAC;IAClC,OAAO,mMAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAKO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,OAAO,mMAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAKO,eAAe,gBAAgB,KAAa;IACjD,MAAM,IAAA,oIAAS;IACf,MAAM,OAAO,MAAM,+HAAI,CAAC,OAAO,CAAC;QAAE,OAAO,MAAM,WAAW;IAAG,GAAG,MAAM,CAAC;IACvE,OAAO,OAAO,KAAK,QAAQ,KAAK;AAClC;AAKO,eAAe,eAAe,MAAc;IACjD,MAAM,IAAA,oIAAS;IACf,MAAM,OAAO,MAAM,+HAAI,CAAC,QAAQ,CAAC;IACjC,IAAI,CAAC,MAAM,OAAO;IAElB,OAAO;QACL,IAAI,KAAK,GAAG,CAAC,QAAQ;QACrB,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;QACf,MAAM,KAAK,IAAI;IACjB;AACF;AAKO,eAAe,WACpB,IAAY,EACZ,KAAa,EACb,QAAgB,EAChB,IAA6C;IAE7C,MAAM,IAAA,oIAAS;IAEf,MAAM,eAAe,MAAM,+HAAI,CAAC,OAAO,CAAC;QAAE,OAAO,MAAM,WAAW;IAAG;IACrE,IAAI,cAAc;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,eAAe,MAAM,aAAa;IAExC,MAAM,OAAO,MAAM,+HAAI,CAAC,MAAM,CAAC;QAC7B;QACA,OAAO,MAAM,WAAW;QACxB;QACA;IACF;IAEA,OAAO;QACL,KAAK,KAAK,GAAG,CAAC,QAAQ;QACtB,MAAM,KAAK,IAAI;QACf,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;QACf,UAAU,KAAK,QAAQ;IACzB;AACF"}},
    {"offset": {"line": 278, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/models/Business.ts"],"sourcesContent":["import mongoose, { Schema, type Document } from \"mongoose\"\nimport type { IBusiness } from \"../types\"\n\ninterface BusinessDocument extends Document, IBusiness {}\n\nconst businessSchema = new Schema<BusinessDocument>(\n  {\n    ownerId: {\n      type: Schema.Types.ObjectId,\n      ref: \"User\",\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    description: {\n      type: String,\n      required: true,\n    },\n    category: {\n      type: String,\n      default: null,\n    },\n    latitude: {\n      type: Number,\n      required: true,\n    },\n    longitude: {\n      type: Number,\n      required: true,\n    },\n    status: {\n      type: String,\n      enum: [\"pending\", \"under_review\", \"verified\", \"approved\", \"rejected\"],\n      default: \"pending\",\n      required: true,\n    },\n    minInvestmentAmount: {\n      type: Number,\n      required: true,\n      min: 0,\n    },\n    maxInvestmentAmount: {\n      type: Number,\n      required: true,\n      min: 0,\n    },\n    expectedReturnPercentage: {\n      type: Number,\n      default: null,\n    },\n    documents: {\n      type: [Schema.Types.ObjectId],\n      ref: \"Document\",\n      default: [],\n    },\n    monthlyRevenue: {\n      type: Number,\n      default: null,\n    },\n    profitMargin: {\n      type: Number,\n      default: null,\n    },\n    growthPercentage: {\n      type: Number,\n      default: null,\n    },\n    customerCount: {\n      type: Number,\n      default: null,\n    },\n  },\n  {\n    timestamps: true,\n  },\n)\n\n// Indexes for performance\nbusinessSchema.index({ ownerId: 1 })\nbusinessSchema.index({ status: 1 })\nbusinessSchema.index({ createdAt: -1 })\n\nexport const Business = mongoose.models.Business || mongoose.model<BusinessDocument>(\"Business\", businessSchema)\n"],"names":[],"mappings":";;;;AAAA;;AAKA,MAAM,iBAAiB,IAAI,mHAAM,CAC/B;IACE,SAAS;QACP,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;IACZ;IACA,MAAM;QACJ,MAAM;QACN,UAAU;IACZ;IACA,aAAa;QACX,MAAM;QACN,UAAU;IACZ;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,UAAU;QACR,MAAM;QACN,UAAU;IACZ;IACA,WAAW;QACT,MAAM;QACN,UAAU;IACZ;IACA,QAAQ;QACN,MAAM;QACN,MAAM;YAAC;YAAW;YAAgB;YAAY;YAAY;SAAW;QACrE,SAAS;QACT,UAAU;IACZ;IACA,qBAAqB;QACnB,MAAM;QACN,UAAU;QACV,KAAK;IACP;IACA,qBAAqB;QACnB,MAAM;QACN,UAAU;QACV,KAAK;IACP;IACA,0BAA0B;QACxB,MAAM;QACN,SAAS;IACX;IACA,WAAW;QACT,MAAM;YAAC,mHAAM,CAAC,KAAK,CAAC,QAAQ;SAAC;QAC7B,KAAK;QACL,SAAS,EAAE;IACb;IACA,gBAAgB;QACd,MAAM;QACN,SAAS;IACX;IACA,cAAc;QACZ,MAAM;QACN,SAAS;IACX;IACA,kBAAkB;QAChB,MAAM;QACN,SAAS;IACX;IACA,eAAe;QACb,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,0BAA0B;AAC1B,eAAe,KAAK,CAAC;IAAE,SAAS;AAAE;AAClC,eAAe,KAAK,CAAC;IAAE,QAAQ;AAAE;AACjC,eAAe,KAAK,CAAC;IAAE,WAAW,CAAC;AAAE;AAE9B,MAAM,WAAW,oHAAQ,CAAC,MAAM,CAAC,QAAQ,IAAI,oHAAQ,CAAC,KAAK,CAAmB,YAAY"}},
    {"offset": {"line": 377, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/lib/models/Document.ts"],"sourcesContent":["import mongoose, { Schema, type Document } from \"mongoose\"\nimport type { IDocument } from \"../types\"\n\ninterface DocumentDocument extends Document, IDocument {}\n\nconst documentSchema = new Schema<DocumentDocument>(\n  {\n    businessId: {\n      type: Schema.Types.ObjectId,\n      ref: \"Business\",\n      required: true,\n    },\n    fileName: {\n      type: String,\n      required: true,\n    },\n    fileUrl: {\n      type: String,\n      required: true,\n    },\n    documentType: {\n      type: String,\n      enum: [\"registration\", \"license\", \"financials\", \"image\", \"proof\", \"other\"],\n      required: true,\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now,\n    },\n    verified: {\n      type: Boolean,\n      default: false,\n    },\n    verifiedBy: {\n      type: Schema.Types.ObjectId,\n      ref: \"User\",\n      default: null,\n    },\n    verifiedAt: {\n      type: Date,\n      default: null,\n    },\n  },\n  {\n    timestamps: false, // Only use uploadedAt\n  },\n)\n\n// Index for business documents\ndocumentSchema.index({ businessId: 1 })\n\nexport const DocumentModel = mongoose.models.Document || mongoose.model<DocumentDocument>(\"Document\", documentSchema)\n"],"names":[],"mappings":";;;;AAAA;;AAKA,MAAM,iBAAiB,IAAI,mHAAM,CAC/B;IACE,YAAY;QACV,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,UAAU;IACZ;IACA,UAAU;QACR,MAAM;QACN,UAAU;IACZ;IACA,SAAS;QACP,MAAM;QACN,UAAU;IACZ;IACA,cAAc;QACZ,MAAM;QACN,MAAM;YAAC;YAAgB;YAAW;YAAc;YAAS;YAAS;SAAQ;QAC1E,UAAU;IACZ;IACA,YAAY;QACV,MAAM;QACN,SAAS,KAAK,GAAG;IACnB;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;IACA,YAAY;QACV,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAC3B,KAAK;QACL,SAAS;IACX;IACA,YAAY;QACV,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;AACd;AAGF,+BAA+B;AAC/B,eAAe,KAAK,CAAC;IAAE,YAAY;AAAE;AAE9B,MAAM,gBAAgB,oHAAQ,CAAC,MAAM,CAAC,QAAQ,IAAI,oHAAQ,CAAC,KAAK,CAAmB,YAAY"}},
    {"offset": {"line": 438, "column": 0}, "map": {"version":3,"sources":["file:///Users/priyanshkakkad/Downloads/investment-platform-design/app/api/businesses/%5Bid%5D/documents/%5BdocId%5D/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { getServerSession } from \"next-auth\"\nimport { authOptions } from \"@/lib/db/auth\"\nimport connectDB from \"@/lib/db/mongoose\"\nimport { Business } from \"@/lib/models/Business\"\nimport { DocumentModel } from \"@/lib/models/Document\"\n\nexport async function DELETE(\n  request: Request,\n  { params }: { params: Promise<{ id: string; docId: string }> }\n) {\n  const { id, docId } = await params\n  const session = await getServerSession(authOptions)\n\n  if (!session?.user) {\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\n  }\n\n  await connectDB()\n\n  try {\n    const business = await Business.findById(id)\n    if (!business) {\n      return NextResponse.json({ error: \"Business not found\" }, { status: 404 })\n    }\n\n    if (session.user.role !== \"admin\" && business.ownerId.toString() !== session.user.id) {\n      return NextResponse.json({ error: \"Forbidden\" }, { status: 403 })\n    }\n\n    await DocumentModel.findByIdAndDelete(docId)\n    await Business.findByIdAndUpdate(id, { $pull: { documents: docId } })\n\n    return NextResponse.json({ message: \"Document deleted\" })\n  } catch (error) {\n    return NextResponse.json({ error: \"Failed to delete document\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAEO,eAAe,OACpB,OAAgB,EAChB,EAAE,MAAM,EAAsD;IAE9D,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,GAAG,MAAM;IAC5B,MAAM,UAAU,MAAM,IAAA,6WAAgB,EAAC,kIAAW;IAElD,IAAI,CAAC,SAAS,MAAM;QAClB,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;IAEA,MAAM,IAAA,kIAAS;IAEf,IAAI;QACF,MAAM,WAAW,MAAM,uIAAQ,CAAC,QAAQ,CAAC;QACzC,IAAI,CAAC,UAAU;YACb,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;QAEA,IAAI,QAAQ,IAAI,CAAC,IAAI,KAAK,WAAW,SAAS,OAAO,CAAC,QAAQ,OAAO,QAAQ,IAAI,CAAC,EAAE,EAAE;YACpF,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAY,GAAG;gBAAE,QAAQ;YAAI;QACjE;QAEA,MAAM,4IAAa,CAAC,iBAAiB,CAAC;QACtC,MAAM,uIAAQ,CAAC,iBAAiB,CAAC,IAAI;YAAE,OAAO;gBAAE,WAAW;YAAM;QAAE;QAEnE,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmB;IACzD,EAAE,OAAO,OAAO;QACd,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}